{
    "version": "https://jsonfeed.org/version/1",
    "title": "ohayo's blog • All posts by \"log\" category",
    "description": null,
    "home_page_url": "https://blog.bysegfault.com",
    "items": [
        {
            "id": "https://blog.bysegfault.com/log/suzhuo-library-wifi/",
            "url": "https://blog.bysegfault.com/log/suzhuo-library-wifi/",
            "title": "苏州图书馆wifi认证",
            "date_published": "2025-06-04T02:49:41.000Z",
            "content_html": "<h1 id=\"苏州图书馆wifi认证之旅\"><a class=\"markdownIt-Anchor\" href=\"#苏州图书馆wifi认证之旅\"></a> 苏州图书馆wifi认证之旅</h1>\n<p>上个月月底去苏州图书馆自习(看HLE vs T1)，难受的是流量在来苏州的路上用的已经差不多了，而苏州图书馆wifi的portal认证验证码却无法收到。想着以后可能经常会来这里自习，还是尝试破解一下吧。</p>\n<h2 id=\"绕过portal认证\"><a class=\"markdownIt-Anchor\" href=\"#绕过portal认证\"></a> 绕过portal认证</h2>\n<p>抱着试试看的心态，先试了理工科大学生必经之路之用53端口绕过校园网认证。没想到在连接上图书馆的公共wifi后，用dig命令发现53端口竟然是开放的。</p>\n<p>这种方案原理很简单，wifi可以转发dns请求，我们只需要一台服务器，把全部的请求伪装成dns请求发给服务器，服务器解包后请求正常网站，再把回应打包成dns回应回复给我们，我们再拆包就可以了。dns2tcp的方案网上有很多实现，这里因为博主不想用服务器的原因就没有使用这种方案。</p>\n<h2 id=\"f12大法\"><a class=\"markdownIt-Anchor\" href=\"#f12大法\"></a> F12大法</h2>\n<p>在poral认证页面，除了手机验证码认证外，没有其他选项了。一般的公共wifi都会照顾一些特殊群体，开放一些特殊认证，例如访客认证、注册用户认证等等。这些认证可能因为鉴权不严格让我们钻空子。</p>\n<p>F12打开控制台，在大致看了一下前端代码后，果然不出所料。除了手机号认证外，还有微信认证、邮箱认证、快速认证等等。</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">pcweixin_auth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token keyword\">var</span> userMac <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#userMac\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">var</span> ssid <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#ssid\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">var</span> userip <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#userip\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">var</span> port <span class=\"token operator\">=</span> <span class=\"token function\">imc_portal_function_readByodServerHttpPort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">var</span> ip<span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// æ ¹æ®å®¢æ·ç«¯ipæ¯v4è¿æ¯v6æ¥è¯¢å¯¹åºå½¢å¼çå¾®ä¿¡æå¡å¨å°å</span>\n\t<span class=\"token keyword\">var</span> ipVersion <span class=\"token operator\">=</span> <span class=\"token function\">imc_portal_function_getClientIPVersion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ipVersion <span class=\"token operator\">==</span> <span class=\"token constant\">IP_VERSION_V4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\tip <span class=\"token operator\">=</span> <span class=\"token function\">imc_portal_function_readWeixinAddress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ipVersion <span class=\"token operator\">==</span> <span class=\"token constant\">IP_VERSION_V6</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\tip <span class=\"token operator\">=</span> <span class=\"token string\">\"[\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">imc_portal_function_readWeixinAddressIPv6</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"]\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token keyword\">var</span> authUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"http://\"</span> <span class=\"token operator\">+</span> ip <span class=\"token operator\">+</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> port <span class=\"token operator\">+</span> <span class=\"token string\">\"/weixin/wifiCode.jsp?ssid=\"</span> <span class=\"token operator\">+</span> ssid <span class=\"token operator\">+</span> <span class=\"token string\">\"&amp;userip=\"</span> <span class=\"token operator\">+</span> userip <span class=\"token operator\">+</span> <span class=\"token string\">\"&amp;usermac=\"</span> <span class=\"token operator\">+</span> userMac<span class=\"token punctuation\">;</span>\n\twindow<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>authUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">weixin_auth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">imc_portal_function_ifQuickAuth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">var</span> r <span class=\"token operator\">=</span> <span class=\"token function\">f_preLoginForInputPanel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>r<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t<span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\n\t<span class=\"token keyword\">var</span> showWechat <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">var</span> data<span class=\"token punctuation\">;</span>\n\t$<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/portal/pws?t=wechatAuth\"</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token literal-property property\">cache</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token literal-property property\">async</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token literal-property property\">dataType</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#form1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">serializeArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token function-variable function\">beforeSend</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t<span class=\"token function\">i_p_f_pageLoading</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"start\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">json</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\tdata <span class=\"token operator\">=</span> json<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token function-variable function\">error</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token function-variable function\">complete</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t<span class=\"token function\">i_p_f_pageLoading</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"complete\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>data <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\t<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#id_text_networkerror\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\t<span class=\"token keyword\">var</span> json <span class=\"token operator\">=</span> <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"(\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">i_p_f_base64DecodeAndUrlDecode</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\")\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">.</span>resultCode <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\t\t<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#id_text_phone_invalid\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\tshowWechat <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">&#125;</span>\n\t\t\t<span class=\"token punctuation\">&#125;</span>\n\t\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>showWechat<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\n\n\t<span class=\"token keyword\">var</span> phone <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#id_userName\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">var</span> userMac <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#userMac\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">var</span> ssid <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#ssid\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">var</span> userip <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#userip\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">var</span> port <span class=\"token operator\">=</span> <span class=\"token function\">imc_portal_function_readByodServerHttpPort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">var</span> ip<span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// æ ¹æ®å®¢æ·ç«¯ipæ¯v4è¿æ¯v6æ¥è¯¢å¯¹åºå½¢å¼çå¾®ä¿¡æå¡å¨å°å</span>\n\t<span class=\"token keyword\">var</span> ipVersion <span class=\"token operator\">=</span> <span class=\"token function\">imc_portal_function_getClientIPVersion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ipVersion <span class=\"token operator\">==</span> <span class=\"token constant\">IP_VERSION_V4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\tip <span class=\"token operator\">=</span> <span class=\"token function\">imc_portal_function_readWeixinAddress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ipVersion <span class=\"token operator\">==</span> <span class=\"token constant\">IP_VERSION_V6</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\t\tip <span class=\"token operator\">=</span> <span class=\"token string\">\"[\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">imc_portal_function_readWeixinAddressIPv6</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"]\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">&#125;</span>\n\t<span class=\"token keyword\">var</span> authUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"http://\"</span> <span class=\"token operator\">+</span> ip <span class=\"token operator\">+</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> port <span class=\"token operator\">+</span> <span class=\"token string\">\"/weixin/wifi2.jsp?phone=\"</span> <span class=\"token operator\">+</span> phone <span class=\"token operator\">+</span> <span class=\"token string\">\"&amp;ac%2Dip=10%2E100%2E63%2E1&amp;ssid=http%3A%2F%2F1%2E1%2E1%2E1&amp;user%2Dipaddress=NECSE%2DWIFI&amp;uaddress=10%2E100%2E68%2E127&amp;umac=d0c637a6ecf3\"</span><span class=\"token punctuation\">;</span>\n\twindow<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span>authUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>直接在控制台中调用这两个函数后，发现<code>imc_portal_function_readWeixinAddress</code>函数返回的是null，微信认证还没有接入。顺着<code>imc_portal_function_readWeixinAddress</code>发现了访客的注册地址。</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">imc_portal_function_readWeixinAddress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">'null'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">imc_portal_function_readWeixinAddressIPv6</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">'null'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">imc_portal_function_readHttpPortIMC</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">'null'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">imc_portal_function_getClientIPVersion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">imc_portal_function_goForgotPwd</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\n    window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href <span class=\"token operator\">=</span> <span class=\"token string\">\"http://10.211.183.232:9066/ssvui/selfservice/mail/forgetPassword.html?sourcePage=portal&amp;nasRedirectUrl=\"</span> <span class=\"token operator\">+</span> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">imc_portal_function_goModify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"/portal/page/modifyPwdAlone.jsp\"</span> <span class=\"token operator\">+</span> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">imc_portal_function_guestRegister</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\n    window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href <span class=\"token operator\">=</span> <span class=\"token string\">\"http://10.211.183.232:9066/ssvui/selfservice/preregister/guestPreregister.html?fromPortalService=true&amp;nasRedirectUrl=\"</span> <span class=\"token operator\">+</span> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">imc_portal_function_inodeDownload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n\n    window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href <span class=\"token operator\">=</span> <span class=\"token string\">\"http://10.211.183.232:9066/ssvui/selfservice/preregister/clientDown.html\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>非常幸运，访客认证的地址<code>http://10.211.183.232:9066/ssvui/selfservice/preregister/guestPreregister.html</code>可以访问，并且注册没有进行检测。随便填了一个信息就可以注册使用wifi了。<br />\n访客wifi告知仅一天有效期且仅限一台设备。当天发现手机和电脑可以同时使用。隔了两天又去了图书馆，居然没失效诶，还能继续用。</p>\n<p>其实这个后台渗透进去非常容易，因为可以上网了就没有往下继续进行了。</p>\n<h2 id=\"下策未实践\"><a class=\"markdownIt-Anchor\" href=\"#下策未实践\"></a> 下策（未实践）</h2>\n<ul>\n<li>通过arp中间人攻击，截获其他设备的数据包，把其他人的认证信息拿到自己用。</li>\n<li>直接问其他人，让我用用你的。(黑客的最佳实践)</li>\n</ul>\n",
            "tags": [
                "log"
            ]
        },
        {
            "id": "https://blog.bysegfault.com/log/openwrt/openwrt-dns/",
            "url": "https://blog.bysegfault.com/log/openwrt/openwrt-dns/",
            "title": "openwrt插件篇-openclash&adguardhome",
            "date_published": "2023-09-03T12:59:49.000Z",
            "content_html": "<p>DNS（<strong>D</strong>omain <strong>N</strong>ame <strong>S</strong>ystem），网络域名系统。可以把它对应手机里的联系人，通过联系人的名字就可以找到电话号码，也能通过手机号找到对应联系人的信息，从而能够准确给特定人拨打电话或者发短信等等。而DNS会把网络域名转换成ip，也能把ip转换成网络域名。</p>\n<p><img data-src=\"https://static.bysegfault.com/old_img/20230903211232.png\" alt=\"image.png\" /></p>\n<h2 id=\"adguardhome\"><a class=\"markdownIt-Anchor\" href=\"#adguardhome\"></a> AdguardHome</h2>\n<p>AdguardHome 是一个本地DNS转发器，同时能过滤广告或者网站等，<code>GitHub</code>开源。下文简称为ADHome。<br />\n值得庆幸的是，ADHome在openwrt上也能用，首先说一下这个软件能带来哪些好处。</p>\n<p>在上图，浏览一个网站时，会先进行DNS查询，获取网站的IP，这个过程十分慢，会极大影响上网体验，其次在我们连接到Wi-Fi上网时，很可能我们正在使用的设备DNS会被劫持，也就是说不是<code>8.8.8.8|1.1.1.1</code>等公共的DNS服务器，它可能是某个老油条自己搭建的一个，同时把你想访问的网站ip，换成他设定的，这就十分的危险了。</p>\n<p>把DNS默认设置为ADHome的DNS服务端口，你的每一条DNS请求都会走ADHome的DNS服务，就可以防止DNS被劫持，同时为ADHome设置一些公共的DNS服务器上游，在收到DNS请求时，它会并发向这些上游DNS服务器请求，根据你的选择，可以返回最快的，也可以是其他情况。</p>\n<p>如此说来，ADHome兼并smartdns等软件的功能，同时还具备过滤功能，可以设置黑名单来屏蔽广告等。没有理由不装！！！<a href=\"https://github.com/rufengsuixing/luci-app-adguardhome\">openwrt链接</a></p>\n<p><img data-src=\"https://static.bysegfault.com/old_img/20230903214014.png\" alt=\"image.png\" /></p>\n<p>以下是我的dns备用</p>\n<pre class=\"line-numbers language-text\" data-language=\"text\"><code class=\"language-text\"># 上游服务器\n114.114.114.114\n223.5.5.5\n180.76.76.76\n1.1.1.1\n8.8.8.8\n8.8.4.4\n117.50.10.10\n180.184.1.1\n101.101.101.101\nhttps://public.dns.iij.jp/dns-query\nhttps://dns.google/dns-query\nhttps://1.1.1.1/dns-query<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>去广告用的是anti-ad公开的广告库—&gt;<a href=\"https://anti-ad.net/easylist.txt\">传送</a><br />\n<img data-src=\"https://static.bysegfault.com/old_img/20230903214228.png\" alt=\"image.png\" /></p>\n<h2 id=\"openclash\"><a class=\"markdownIt-Anchor\" href=\"#openclash\"></a> openclash</h2>\n<p>openclash是clash的openwrt版本，安装完meta内核，基本和电脑端的规则兼容，一套规则，全平台使用，还是很不错滴。<br />\n就不过多写这个了。</p>\n<h2 id=\"openclashadhome\"><a class=\"markdownIt-Anchor\" href=\"#openclashadhome\"></a> openclash+ADHome</h2>\n<p>这才是硬路由的终极方案，openclash劫持53端口的DNS转发，同时将openclash的DNS上游设置为ADHome。<br />\n如此一来，DNS请求—&gt;53端口DNS—&gt;openclash—&gt;ADHome。</p>\n<p>openclash配置如下，其中8053为ADHome服务端口。<br />\n<img data-src=\"https://static.bysegfault.com/old_img/20230903215059.png\" alt=\"image.png\" /></p>\n<p>ADHome配置如下<br />\n<img data-src=\"https://static.bysegfault.com/old_img/20230903215153.png\" alt=\"image.png\" /></p>\n<h2 id=\"dns测速对比\"><a class=\"markdownIt-Anchor\" href=\"#dns测速对比\"></a> DNS测速对比</h2>\n<p>根据使用情况，smartdns与ADHome dns查询速度基本一致，这里对比的是smartdns与正常情况下的DNS。<br />\n速率对比是玄学，主要用途是为了防止DNS被劫持。</p>\n<p>正常情况如下<br />\n<img data-src=\"https://static.bysegfault.com/old_img/20230903215643.png\" alt=\"image.png\" /></p>\n<p>使用smartdns情况如下<br />\n<img data-src=\"https://static.bysegfault.com/old_img/20230903215805.png\" alt=\"image.png\" /></p>\n<p>尽管dns查询速度这块是玄学，实际使用上来说，提升是有的，搭配openclash秒开YouTube。</p>\n<p>最后不得不说6088这款路由器，真滴强，openclash➕ADHome等应用一点压力都没。<br />\n<img data-src=\"https://static.bysegfault.com/old_img/20230903220047.png\" alt=\"image.png\" /></p>\n<hr />\n<p>想把博客从hexo转移到hugo，之前改的配置，都不记得改了那里，很难受，算了，先这样吧，等11.11买完新电脑，再迁移吧。</p>\n",
            "tags": [
                "openwrt"
            ]
        },
        {
            "id": "https://blog.bysegfault.com/log/openwrt/tl6088/",
            "url": "https://blog.bysegfault.com/log/openwrt/tl6088/",
            "title": "tl6088刷机之旅",
            "date_published": "2023-08-27T15:16:59.000Z",
            "content_html": "<p>最近又换了一台路由器，TP-link-6088，因为上个月买了台switch，无论怎么换DNS，下载速度依旧感人至深。转手就把小米AX6000卖了，其实小米AX6000已经能满足我的日常的绝大需求，唯一缺点就是自由度不够，迟来的switch打破昔日的平静。</p>\n<h2 id=\"为啥选择tl6088\"><a class=\"markdownIt-Anchor\" href=\"#为啥选择tl6088\"></a> 为啥选择tl6088？</h2>\n<p>对，这是个好问题，身为一个小垃圾佬，先后了解很多路由器，结合我的需求，要能刷openwrt，运行内存至少要512，CPU要好一些，处理网络数据包的同时，要留有余地去跑一些第三方服务。闪存要高一些，至少64。<br />\n最重要的是价格一定要便宜！！！<br />\n如此这般，候选路由器1号----红米ax6000，2号----tl6088，3号----tl6080。<br />\n红米ax6000在配置上几乎与6088完全一样，加上是米家的路由器，再熟悉不过，可惜没有2.5G网口，惨遭淘汰。<br />\n6088和6080，jd搞活动，价格相差不大，最终选择了6088，6百多拿下。</p>\n<h2 id=\"刷机openwrt\"><a class=\"markdownIt-Anchor\" href=\"#刷机openwrt\"></a> 刷机openwrt</h2>\n<p>tp家的路由器和米家的不一样，我看很多论坛上说tp的刷机过程比较繁琐。之前玩的红米ax6，刷机已经很繁琐了。我敲，这不会又是一个通宵吧。</p>\n<p>还好小马过河，实际比红米ax6省事不少，利用6088的vpn漏洞，注入刷机包，再通过tftp服务，把recover传入，整体过程一气呵成，大概20分钟，就刷完了。</p>\n<p><img data-src=\"https://static.bysegfault.com/old_img/20230827235738.png\" alt=\"image.png\" /></p>\n<p>具体的参考文章可以看===&gt;<a href=\"https://blog.lishun.me/tl-xdr608x-openwrt-install\">这篇文章</a>，作者很谨慎，传输的文件都加了md5验证文件唯一性，胆大心细，十分nice。</p>\n<h2 id=\"配置openwrt\"><a class=\"markdownIt-Anchor\" href=\"#配置openwrt\"></a> 配置openwrt</h2>\n<p>家里的电线光猫，全国通用密码，直接8080端口找到老web地址，把宽带账号&amp;&amp;密码记下来，删除第三个路由模式，创建一个桥接模式，钩上端口，最后关闭光猫的DHCP。</p>\n<p>openwrt这边就容易多了，我用的是wan6接口拨号上网，其他默认就行。最后设置完Wi-Fi密码，把国家代码改成AU，澳大利亚提高无线功率。</p>\n<h3 id=\"插件\"><a class=\"markdownIt-Anchor\" href=\"#插件\"></a> 插件</h3>\n<p>openwrt最好玩儿的地方。</p>\n<p>我目前安装的插件</p>\n<ul>\n<li>open clash</li>\n<li>smartdns</li>\n<li>upnp</li>\n<li>uu加速器</li>\n</ul>\n<p>smartdns具有很好的dns查询效果，自己设置完上游dns后，网页打开能快不少，不是吹的。</p>\n<p>smartdns作为openclash的上游dns，有很好的加速效果，upnp就不用多说了，必装插件，打游戏嗖嗖滴。</p>\n<p>uu加速器，害，一个臭打游戏的插件，加速主机，要什么小黑盒，都没用。</p>\n<hr />\n<p>简单记录一下新路由器的之旅，openwrt还有很多地方不懂，这周会开始逐步搞懂，最后记录一个通用的图文配置，以备不时之需。</p>\n<p>唉，这周之前不到2刀买的域名过期了，导致我一堆的服务都歇菜了，azure for student 订阅也没多少了，希望黑5能找到好机子，下周会先配置完nvim，然后研究一下ws协议等，没有这些东西，程序员简直没法生活啊。抽空会更新c语言&amp;&amp;汇编。</p>\n",
            "tags": [
                "openwrt"
            ]
        },
        {
            "id": "https://blog.bysegfault.com/log/hexo-log/",
            "url": "https://blog.bysegfault.com/log/hexo-log/",
            "title": "hexo博客更新",
            "date_published": "2022-12-05T08:15:00.000Z",
            "content_html": "<h2 id=\"更新动机\"><a class=\"markdownIt-Anchor\" href=\"#更新动机\"></a> 更新动机</h2>\n<p>一直没找到写作、UI都让我感觉很舒服的主题。</p>\n<p>之前的主题很好看，有很多插件，更多的是用来写「笔记」或者「练习题」，因为写作很不方便，而且时不时渲染会出错，每次都要写好久，就有了这次的换主题。</p>\n<h2 id=\"以后安排\"><a class=\"markdownIt-Anchor\" href=\"#以后安排\"></a> 以后安排</h2>\n<p>之前的hexo主题，会写以后的错题、考试等等。<br />\n这个主题会记录数学、分享等等，同时会接着改造。</p>\n",
            "tags": [
                "log"
            ]
        },
        {
            "id": "https://blog.bysegfault.com/log/openwrt/redmiAx6/",
            "url": "https://blog.bysegfault.com/log/openwrt/redmiAx6/",
            "title": "折腾红米ax6",
            "date_published": "2022-04-30T12:47:11.000Z",
            "content_html": "<p>此篇记录一下前段时间折腾路由器的经历。哈哈哈哈哈，真是太爽了，路由器这东西，真上头。</p>\n<p>📍</p>\n<h1 id=\"选择路由器\"><a class=\"markdownIt-Anchor\" href=\"#选择路由器\"></a> 选择路由器</h1>\n<p>我选的是红米ax6，这款路由器，可以说是理财产品了，哈哈哈哈，价格一直涨，二手原价卖。就离谱。</p>\n<p>我主要是看重它以下几点</p>\n<ul>\n<li>芯片好，高通的芯片，散热刚刚滴~</li>\n<li>支持wifi6</li>\n<li>穿墙也不错</li>\n</ul>\n<p>加上看好碰见小米商城有货，我直接手起刀落。</p>\n<p>长个样子。</p>\n<p><img data-src=\"https://static.bysegfault.com/old_img/image-20220505005059497.png\" alt=\"image-20220505005059497\" /></p>\n<h1 id=\"刷openwrt\"><a class=\"markdownIt-Anchor\" href=\"#刷openwrt\"></a> 刷openwrt</h1>\n<p>openwrt一个开源的路由器系统，可玩性强，深受“大家”喜爱，我也不例外，诶~，年轻就是折腾。</p>\n<p>我用的openwrt是直接在恩山下载一个网友的。不得不说，英雄所见略同。这个网友和我一样，只有一个需求，就是能科学上网就行啦。</p>\n<p><img data-src=\"https://static.bysegfault.com/old_img/image-20220430210845243.png\" alt=\"image-20220430210845243\" /></p>\n<p>插件这块大家可以自己装啦。</p>\n<p>米家的固件实在是苦不堪言，红米ax6跑千M网和玩一样，根本没有压力。我选择openwrt更高的自由度。</p>\n<h2 id=\"解锁ssh\"><a class=\"markdownIt-Anchor\" href=\"#解锁ssh\"></a> 解锁SSH</h2>\n<p>ax6最难刷机的原因就是SSH太难解。</p>\n<p>我是参考的b站这位网友给的教程，解锁的。<a href=\"https://www.bilibili.com/video/BV1q94y1f7fj\">视频链接</a></p>\n<p>我不是特别喜欢这个视频的风格，所以这里我简单概括一下他说的这些东西。</p>\n<ol>\n<li>\n<p>将AX6的固件降级为1.0.18版本</p>\n</li>\n<li>\n<p>红米ax6解锁需要一个openwrt路由（能上网的）。</p>\n</li>\n<li>\n<p>用虚拟机搭建一个openwrt系统的虚拟路由，就是开一个虚拟机。配置网络环境虚拟机网络环境</p>\n</li>\n<li>\n<p>上传wireless.sh文件到虚拟机，执行 sh /root/wireless.sh</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\">#wireless.sh如下</span>\n<span class=\"token comment\">#!/bin/ash</span>\n<span class=\"token comment\"># SPDX-License-Identifier: GPL-3.0-only</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># Copyright (C) 2020 yyjdelete</span>\n<span class=\"token comment\"># Copyright (C) 2021 Robert Marko &lt;robimarko@gmail.com></span>\n<span class=\"token comment\"># Copyright (C) 2021 Tianling Shen &lt;cnsztl@immortalwrt.org></span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># Original threads:</span>\n<span class=\"token comment\"># Redmi AX6 AX3000: https://www.right.com.cn/forum/thread-4060726-1-1.html</span>\n<span class=\"token comment\"># Xiaomi AX6000/AX9000: https://forum.openwrt.org/t/openwrt-support-for-xiaomi-ax9000/98908/34</span>\n\n<span class=\"token assign-left variable\">info_font</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\033\">\\033</span>[36m[Info]<span class=\"token entity\" title=\"\\033\">\\033</span>[0m\"</span>\n<span class=\"token assign-left variable\">success_font</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\033\">\\033</span>[32m[Success]<span class=\"token entity\" title=\"\\033\">\\033</span>[0m\"</span>\n<span class=\"token assign-left variable\">warning_font</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\033\">\\033</span>[33m[Warning]<span class=\"token entity\" title=\"\\033\">\\033</span>[0m\"</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token variable\">$&#123;warning_font&#125;</span> Please make sure your router has wireless support!\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token variable\">$&#123;warning_font&#125;</span> Please make sure your router is restored to factory settings (not configured)!\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token variable\">$&#123;warning_font&#125;</span> Please make sure you've backed up the network and wireless settings!\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token variable\">$&#123;warning_font&#125;</span> Please make sure you've connected the router via *wired ethernet*!\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token variable\">$&#123;warning_font&#125;</span> Running this script will change your *network* settings!\"</span>\n<span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-p</span> <span class=\"token string\">\"Use Ctrl+C to exit or press enter key to continue...\"</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token variable\">$&#123;info_font&#125;</span> Adding xqsystem controller...\"</span>\n<span class=\"token function\">cat</span> <span class=\"token operator\">></span> <span class=\"token string\">\"/usr/lib/lua/luci/controller/admin/xqsystem.lua\"</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">EOF\nmodule(\"luci.controller.admin.xqsystem\", package.seeall)\n\nfunction index()\n    local page   = node(\"api\")\n    page.target  = firstchild()\n    page.title   = (\"\")\n    page.order   = 100\n    page.index = true\n    page   = node(\"api\",\"xqsystem\")\n    page.target  = firstchild()\n    page.title   = (\"\")\n    page.order   = 100\n    page.index = true\n    entry(&#123;\"api\", \"xqsystem\", \"token\"&#125;, call(\"getToken\"), (\"\"), 103, 0x08)\nend\n\nlocal LuciHttp = require(\"luci.http\")\n\nfunction getToken()\n    local result = &#123;&#125;\n    result[\"code\"] = 0\n    result[\"token\"] = \"; nvram set ssh_en=1; nvram set uart_en=1; nvram set boot_wait=on; nvram commit; uci set wireless.@wifi-iface[0].key=\\<span class=\"token variable\"><span class=\"token variable\">`</span>mkxqimage -I<span class=\"token punctuation\">\\</span><span class=\"token variable\">`</span></span>; uci commit; sed -i 's/channel=.*/channel=<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>debug<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>/g' /etc/init.d/dropbear; /etc/init.d/dropbear start;\"\n    LuciHttp.write_json(result)\nend\nEOF</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token variable\">$&#123;info_font&#125;</span> Changing network settings...\"</span>\n<span class=\"token builtin class-name\">set</span> <span class=\"token parameter variable\">-x</span>\n<span class=\"token comment\"># /etc/config/dhcp</span>\nuci <span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">dhcp.lan.ra_management</span><span class=\"token operator\">=</span><span class=\"token string\">'1'</span>\nuci del dhcp.lan.start\nuci del dhcp.lan.limit\nuci del dhcp.lan.leasetime\nuci <span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">dhcp.lan.ignore</span><span class=\"token operator\">=</span><span class=\"token string\">'1'</span>\n<span class=\"token comment\"># /etc/config/network</span>\nuci <span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">network.lan.ipaddr</span><span class=\"token operator\">=</span><span class=\"token string\">'169.254.31.1'</span>\nuci <span class=\"token parameter variable\">-q</span> commit\n<span class=\"token builtin class-name\">set</span> +x\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token variable\">$&#123;success_font&#125;</span> All settings are applied.<span class=\"token entity\" title=\"\\n\">\\n</span>\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token variable\">$&#123;info_font&#125;</span> Please now disconnect from this router, and connect to your Xiaomi/Redmi router.\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token variable\">$&#123;info_font&#125;</span> For Xiaomi AX3000/AX6000/AX9000:\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"       Open your browser, access the following URL:\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"         http://192.168.31.1/cgi-bin/luci/;stok=&lt;STOK>/api/xqsystem/extendwifi_connect_inited_router?ssid=MEDIATEK-ARM-IS-GREAT&amp;password=ARE-YOU-OK&amp;admin_username=root&amp;admin_password=admin&amp;admin_nonce=xxx\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"\"</span>\n\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token variable\">$&#123;warning_font&#125;</span> Restarting network...\"</span>\nwifi reload <span class=\"token operator\">></span><span class=\"token string\">\"/dev/null\"</span> <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span><span class=\"token file-descriptor important\">&amp;1</span>\n/etc/init.d/network restart <span class=\"token operator\">></span><span class=\"token string\">\"/dev/null\"</span> <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span><span class=\"token file-descriptor important\">&amp;1</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li>\n<p>打开windows移动热点，这时候电脑就会多出来一个网卡（这个热点的）</p>\n</li>\n<li>\n<p>把刚刚刷好的openwrt桥接到windows热点上。ps:热点必须联网</p>\n</li>\n<li>\n<p>登录AX6，复制当前AX6后台链接中 “stock=” 后面的字符串；</p>\n</li>\n<li>\n<p>替换链接中相应的数据后，复制到浏览器点击回车，解锁SSH；<br />\n<a href=\"http://192.168.31.1/cgi-bin/luci/;stok=\">http://192.168.31.1/cgi-bin/luci/;stok=</a><stock>/api/xqsystem/extendwifi_connect_inited_router?ssid=op&amp;password=12345678&amp;admin_username=root&amp;admin_password=password&amp;admin_nonce=xxx</p>\n</li>\n<li>\n<p>提示解锁成功之后，再次登录ax6后台，5G频段路由密码，就是SSH密码了</p>\n</li>\n</ol>\n<p>到这里SSH就解锁了。</p>\n<h2 id=\"刷入openwrt\"><a class=\"markdownIt-Anchor\" href=\"#刷入openwrt\"></a> 刷入openwrt</h2>\n<p>红米ax6有两个系统分区，你在0区，就把openwrt刷到0区，反之刷到1区。</p>\n<p>就是说，你在0分区刷，固件会上传到1分区。你在1分区刷，固件会上传到0分区。所以刷之前要切换分区先。</p>\n<p>我这里没扩容，因为第一次刷的那个路由器变砖了，我在网上没找到很完善的扩容方案。不扩容只能刷30m以下的哈，超过会变砖，用小米官方的刷机软件可求回来。但是扩容刷机失败，不能用小米官网的刷机求了。。。</p>\n<p>这样就不会出现变砖的情况了。</p>\n<p>下面以1分区举例</p>\n<ol>\n<li>\n<p>检测当前分区</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">nvram get flag_last_success<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>切换分区</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">nvram <span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">flag_last_success</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\nnvram <span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">flag_boot_rootfs</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\nnvram commit\n<span class=\"token function\">reboot</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li>\n<p>把openwrt的固件上传到/tmp下面，第一次上传.ubi后缀的文件的哈<img data-src=\"https://static.bysegfault.com/old_img/image-20220430212942511.png\" alt=\"image-20220430212942511\" /></p>\n</li>\n<li>\n<p>刷入固件</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">ubiformat /dev/mtd13 <span class=\"token parameter variable\">-y</span> <span class=\"token parameter variable\">-f</span> /tmp/你上传的固件文件名<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>切换分区</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">nvram <span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">flag_last_success</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\nnvram <span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">flag_boot_rootfs</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\nnvram commit\n<span class=\"token function\">reboot</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n</ol>\n<p>结束。</p>\n<p>剩下的就是切换不同系统的代码了</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">OP切换到小米系统\nfw_setenv  flag_last_success <span class=\"token number\">0</span>\nfw_setenv flag_boot_rootfs <span class=\"token number\">0</span>\n<span class=\"token function\">reboot</span>\n\n小米系统切换到OP\nnvram <span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">flag_last_success</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\nnvram <span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">flag_boot_rootfs</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\nnvram commit\n<span class=\"token function\">reboot</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img data-src=\"https://static.bysegfault.com/old_img/image-20220430213828289.png\" alt=\"image-20220430213828289\" /></p>\n<p>我想解锁完ssh之后就已经实现完全自由啦。还有什么是比一个linux更自由的呢~</p>\n<h1 id=\"接入校园网\"><a class=\"markdownIt-Anchor\" href=\"#接入校园网\"></a> 接入校园网</h1>\n<p>河南师范大学的校园网，狗的一，一个账号一个设备。这能行吗？？？咱就是说，一百个不同意。</p>\n<p>ax6有两个频段，5G和2.4G，学校的也是分这俩个频段。</p>\n<p>这里要科普一下这个5G和2.4G频段哈。这里是频率，不是我们手机上说的那个5G时代哈。</p>\n<ul>\n<li>\n<p>5G频段在信号强距离时，抗干扰能力远大于2.4G，其下载速度和上传速度明显哈。</p>\n</li>\n<li>\n<p>2.4G频段信号范围比较广哈，穿墙效果更好。</p>\n</li>\n</ul>\n<p>其实从物理也可得出来啦，5G频段，频率大了，波长短了，衍射效果不好，粒子性更强。波长大的，会更易绕过墙壁等障碍物。</p>\n<p>我所在的寝室校园网5G很好。</p>\n<p><img data-src=\"https://static.bysegfault.com/old_img/image-20220430222656166.png\" alt=\"image-20220430222656166\" /></p>\n<p>我的方案是，用路由器的5G信道，连接到校园网5G网上，在ssh连接路由器，curl命令，发送一个post请求，完成web认证。之后用路由器的2.4G频段就可以上网了。</p>\n<p><img data-src=\"https://static.bysegfault.com/old_img/image-20220430222926530.png\" alt=\"image-20220430222926530\" /></p>\n<p><img data-src=\"https://static.bysegfault.com/old_img/image-20220430223040679.png\" alt=\"image-20220430223040679\" /></p>\n<p><img data-src=\"https://static.bysegfault.com/old_img/image-20220430223440228.png\" alt=\"image-20220430223440228\" /></p>\n<p>在定时运行这个shell脚本，就可以让路由器一直使用学校的校园网啦。</p>\n<p>速度与直连校园网无差别。十分nice</p>\n<p>唉，先到这吧，学校没有ipv6，难受了，加上我的笔记本没法插网线，没法远程开机，难受~。让我们上了研究生再写这篇文章吧。</p>\n",
            "tags": [
                "log"
            ]
        }
    ]
}